function [Dis,P4] = footseeking(P1,P2,P3)
%input
% P1,P2         
% P3            

%output
% Dis          
% P4           
%%

u1 = (P1(:,1)-P2(:,1)).*(P3(:,1)-P1(:,1))+(P1(:,2)-P2(:,2)).*(P3(:,2)-P1(:,2))+ ...
    (P1(:,3)-P2(:,3)).*(P3(:,3)-P1(:,3));
u2 = ((P1(:,1)-P2(:,1)).^2) + ((P1(:,2)-P2(:,2)).^2) + ((P1(:,3)-P2(:,3)).^2);
u = u1/u2;

x4 = (P1(:,1)-P2(:,1)).*u + P1(:,1);
y4 = (P1(:,2)-P2(:,2)).*u + P1(:,2);
z4 = (P1(:,3)-P2(:,3)).*u + P1(:,3);
P4 = [x4 y4 z4];

Dis = pdist2(P3,P4);

end
